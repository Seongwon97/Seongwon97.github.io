{"componentChunkName":"component---src-templates-blog-post-js","path":"/Book/20230403-가상면접_Chapter8/","result":{"data":{"site":{"siteMetadata":{"author":"Seongwon","comment":{"utterances":"Seongwon97/Seongwon97.github.io"},"sponsor":{"buyMeACoffeeId":"seongwon"}}},"markdownRemark":{"excerpt":"문제 이해 및 설계 범위 확정 해당 책에서는 시스템을 설계하기 앞서 요구사항을 정리한다. 아래의 요구사항은 해당 시스템을 만들기 위해 항상 필요한 요구사항이 아닌 예시임을 참고하자. 쓰기 연산: 매일 1억 개의 단축 URL 생성 초당 쓰기 연산 : 1억(100million)/24/3600=1160 읽기 연산: 읽기 연산과 쓰기 연산의 비율은 10:1이라 …","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 912px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 131.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0klEQVRIx+2UXUojQRDH5/s7yTiT+dzEREUFFUkIMeq6q9kNgooIAcUXBQ/go4fwDN7DC3gGb+CTl/hb1SPR4LKwrruI+FB0T3fXr6r/XTWSJEl4Y/sE/g+gokpQtfec4cl5jovLKQSRXqzJrwDKj04TVR03dyu4Rx+Dg3AkwasztGwFV9cLuL7tYKnjFcGUv7yyqsowLeWzsD800DAV8dJ/BOTaUjV5VNDPi3t6zkWr68NxVQJL0HS56G8yRSlsDKhQ9Jl5F/UpG7WGRXNHWHPWwfySi8VWCd2vPpLcRHlCEy3I8yg1kdYsfJm0RbAR0CtpWNsKxIHGtINvgxDr/QDtVR/93Sq6Gz42BgHqTVs4eWUNGYGqiYk4sxBGBvxAfwIyfW0zQF63xGJv08fhWYbhaUoZetjaCbF/nGB4ktJ6jr2jWKwNTzPoRqEtA1kyAXQ9Fe2eL6Jy7/IPgeEsQUDRo9RArWmRBLYYOSOHfGK6EbekRiAGPmopwXZUITofWO5U8HMvQmulQlbG9+2QrhtisV3C+g+SoVcRcnA2fLNaw6Egjgg89soJaZHmFoKqQdqQxYbIhMckM0fzMB7f42/24Zd/UYdcJr+y3+3J8j/ulAeVMTK7lFneOQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/4d0c6b0a13788d3977702c683728c64c/8b69f/%EA%B0%80%EC%83%81_%EB%A9%B4%EC%A0%91_%EC%82%AC%EB%A1%80%EB%A1%9C_%EB%B0%B0%EC%9A%B0%EB%8A%94_%EB%8C%80%EA%B7%9C%EB%AA%A8_%EC%8B%9C%EC%8A%A4%ED%85%9C_%EC%84%A4%EA%B3%84_%EA%B8%B0%EC%B4%88.png\"\n        srcset=\"/static/4d0c6b0a13788d3977702c683728c64c/5a46d/%EA%B0%80%EC%83%81_%EB%A9%B4%EC%A0%91_%EC%82%AC%EB%A1%80%EB%A1%9C_%EB%B0%B0%EC%9A%B0%EB%8A%94_%EB%8C%80%EA%B7%9C%EB%AA%A8_%EC%8B%9C%EC%8A%A4%ED%85%9C_%EC%84%A4%EA%B3%84_%EA%B8%B0%EC%B4%88.png 300w,\n/static/4d0c6b0a13788d3977702c683728c64c/0a47e/%EA%B0%80%EC%83%81_%EB%A9%B4%EC%A0%91_%EC%82%AC%EB%A1%80%EB%A1%9C_%EB%B0%B0%EC%9A%B0%EB%8A%94_%EB%8C%80%EA%B7%9C%EB%AA%A8_%EC%8B%9C%EC%8A%A4%ED%85%9C_%EC%84%A4%EA%B3%84_%EA%B8%B0%EC%B4%88.png 600w,\n/static/4d0c6b0a13788d3977702c683728c64c/8b69f/%EA%B0%80%EC%83%81_%EB%A9%B4%EC%A0%91_%EC%82%AC%EB%A1%80%EB%A1%9C_%EB%B0%B0%EC%9A%B0%EB%8A%94_%EB%8C%80%EA%B7%9C%EB%AA%A8_%EC%8B%9C%EC%8A%A4%ED%85%9C_%EC%84%A4%EA%B3%84_%EA%B8%B0%EC%B4%88.png 912w\"\n        sizes=\"(max-width: 912px) 100vw, 912px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h1 id=\"문제-이해-및-설계-범위-확정\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C-%EC%9D%B4%ED%95%B4-%EB%B0%8F-%EC%84%A4%EA%B3%84-%EB%B2%94%EC%9C%84-%ED%99%95%EC%A0%95\" aria-label=\"문제 이해 및 설계 범위 확정 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>문제 이해 및 설계 범위 확정</h1>\n<blockquote>\n<p>해당 책에서는 시스템을 설계하기 앞서 요구사항을 정리한다. 아래의 요구사항은 해당 시스템을 만들기 위해 항상 필요한 요구사항이 아닌 예시임을 참고하자.</p>\n</blockquote>\n<ul>\n<li>쓰기 연산: 매일 1억 개의 단축 URL 생성</li>\n<li>초당 쓰기 연산 : 1억(100million)/24/3600=1160</li>\n<li>읽기 연산: 읽기 연산과 쓰기 연산의 비율은 10:1이라 가정하면 읽기 연산은 초당 11600회 발생</li>\n<li>URL 단축 서비스를 10년간 운영하였다고 가정하면 1억<em>365</em>10=3650억 개의 레코드를 보관</li>\n<li>축약 전 URL의 평균 길이는 100</li>\n</ul>\n<p>→ 10년간 필요한 저장 용량은 3650억*100바이트=36.5TB</p>\n<h1 id=\"api-엔드-포인트\" style=\"position:relative;\"><a href=\"#api-%EC%97%94%EB%93%9C-%ED%8F%AC%EC%9D%B8%ED%8A%B8\" aria-label=\"api 엔드 포인트 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API 엔드 포인트</h1>\n<p>URL 단축키를 생성하게 된다면 서버는 아래의 두 API를 제공해야하며, 사용자는 해당 API들로 서버와 통신을 한다.</p>\n<ol>\n<li>URL 단축용 엔드포인트</li>\n<li>\n<p>새 URL을 생성하고자 하는 클라이언트는 해당 엔드포인트에 단축할 URL을 실어서 POST요청을 보낸다.</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"xml\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">POST /api/v1/data/shorten</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">인자: {longUrl: longURLString}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">반환: 단축 URL</span></span></span></code></pre>\n</li>\n<li>URL Redirection용 엔드포인트</li>\n<li>\n<p>단축 URL에 대하여 HTTP 요청이 오면 원래 URL로 보내주기 위한 용도의 엔드포인트</p>\n<pre class=\"grvsc-container one-dark-pro\" data-language=\"xml\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">GET /api/v1/shortUrl</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">반환: HTTP Redirection 목적지가 될 원본 URL</span></span></span></code></pre>\n</li>\n<li>원본 URL은 301응답과 함께 location헤더 필드에 주소를 넣어서 반환한다.</li>\n</ol>\n<blockquote>\n<p>📌 <strong>Http Status Code 301과 302의 차이</strong></p>\n<p>301과 302는 모두 Redirection에 사용되는 코드이지만 차이가 있다.</p>\n<ul>\n<li><strong>301 Permanently Moved</strong> : 해당 URL에 대한 HTTP 요청의 처리 책임이 <strong>영구적으로</strong> Location 헤더에 반환된 URL로 이전되었다는 응답이다. 영구적이기에 브라우저는 해당 응답의 Location 데이터를 캐싱하여 다음 요청부터는 캐싱된 URL로 요청을 보낸다.</li>\n<li><strong>302 Found</strong> : URL로의 요청이 <strong>일시적으로</strong> Location 헤더에 반환된 URL에 의해 처리되어야 한다는 응답이다.</li>\n</ul>\n<p>만약 서버의 부하를 줄이는 것이 중요하다면 301 응답을 사용하는 것이 좋다. 하지만 트래픽 분석이 중요할 때는 302를 쓰는 것이 클릭 발생률이나 발생 위치를 추적하는데 조금 더 유리하다.</p>\n</blockquote>\n<h1 id=\"url-단축\" style=\"position:relative;\"><a href=\"#url-%EB%8B%A8%EC%B6%95\" aria-label=\"url 단축 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>URL 단축</h1>\n<p>URL Redirection을 구현하는 직관적인 방법은 해시 테이블을 사용하는 것이다. 이때 해시 함수는 아래의 요구사항을 만족해야 한다.</p>\n<ul>\n<li>입력으로 주어지는 URL이 다른 값이면 해시 값도 달라야 한다.</li>\n<li>계산된 해시 값은 원래 입력으로 주어졌던 긴 URL로 복원될 수 있어야 한다.</li>\n</ul>\n<p>하지만 메모리는 한정적이어서 실세 서비스에서 사용하기에는 적합하지 않아 데이터베이스에 저장하는 것이 좋다.</p>\n<h2 id=\"데이터-모델\" style=\"position:relative;\"><a href=\"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%AA%A8%EB%8D%B8\" aria-label=\"데이터 모델 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>데이터 모델</h2>\n<p>데이터베이스에 id, shortURL, LongURL 컬럼으로 이루어진 테이블을 만들어 데이터를 저장 및 조회한다.</p>\n<h2 id=\"해시-함수\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EC%8B%9C-%ED%95%A8%EC%88%98\" aria-label=\"해시 함수 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해시 함수</h2>\n<p>해시 함수에 쓰일 기술로는 <strong>해시 후 충돌 해소 방법</strong>과 <strong>base-62 변환</strong> 법이 있다.</p>\n<h3 id=\"해시-함수-1---해시-충돌-해소-방법\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EC%8B%9C-%ED%95%A8%EC%88%98-1---%ED%95%B4%EC%8B%9C-%EC%B6%A9%EB%8F%8C-%ED%95%B4%EC%86%8C-%EB%B0%A9%EB%B2%95\" aria-label=\"해시 함수 1   해시 충돌 해소 방법 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해시 함수 1 - 해시 충돌 해소 방법</h3>\n<p>해시 함수는 CRC32, MD5, SHA-1과 같은 대표적인 함수를 이용해도 된다. 하지만 해당 함수들을 이용하면 만들어진 키의 길이가 매우 길어진다. 만들어진 모든 값을 사용해도 되지만, 시스템 설계를 하다보면 저장해야할 URL의 개수와 디스크 용량의 크기를 고려하면 모든 문자열을 다 사용할 수 없고 특정 자리수만 사용해야 한다.</p>\n<blockquote>\n<p>앞서 말한 요구사항을 고려하여 계산해보면 아래와 같다.</p>\n<p>해시 값의 각 자리는 [A-Z, a-z, 0-9]의 문자들로 각각 62개의 값이 위치할 수 있다. 따라서 해시 값의 최대 길이는 저장 용량을 통해 고려해봤을 때 <code>62^n ≥ 3650억</code> 에서 n의 최솟값인 7이 된다. 즉, 글 초반에 언급한 조건에서의 해시 값의 길이는 7로 하는 것이 적합하다.</p>\n</blockquote>\n<p>모든 값이 아닌 해시 값의 특정 Prefix만 사용하면 충돌이 발생할 것이다. 충돌이 발생할 때는 충돌이 해소될 때까지 사전에 정한 문자열을 해시 값에 덧붙이면서 충돌되지 않는 값을 찾으면 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1061px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABSklEQVQoz4WRX26CQBDGuU9P05ceoKfoBfpmj9E+tBcw8c30tbEmgqlRQRHQFQErIH+EX1kSm2q0TDKZnZ1vvm92VllMWow+7/DcD3w/wrEtLMui3+8znU7ZbDY4joMQAsMw0DQN13VrlzhD19HUAUNNrTFKuO0RuG3SxKUsIY5jwjDE8zzG4zG73Y6iKNjv9yRJUtdlLCtwlmXss4JlNYgfZiRZjsKJlSeZbAiCgCiKfgXklLZts1qtmM3nRPYXg9dHZt1n8niLUpZFpXaoFWvKKh79aJLQNE06nQ7tdhtVVXHXa+IkY/7+Ru/hhl7rlmBpSMLT5r/5ee2a6ZZgYjr1WbkGuiRyPr3cte976JMRa+HgV2tRmtQvreJ4l6ZpRRpXe3VZie/qw6JmwiahQ+6z0F/YiO7/T24ik58pbbcdYo7uEeYTeV7wA0oQsiw3ZzGzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/12eba2ffcc027562229abb5aa597cb99/f5209/img.png\"\n        srcset=\"/static/12eba2ffcc027562229abb5aa597cb99/5a46d/img.png 300w,\n/static/12eba2ffcc027562229abb5aa597cb99/0a47e/img.png 600w,\n/static/12eba2ffcc027562229abb5aa597cb99/f5209/img.png 1061w\"\n        sizes=\"(max-width: 1061px) 100vw, 1061px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>해당 방법은 충돌을 해소할 수 있으나 단축 URL을 생성할 때 DB에 한번 이상 쿼리를 날려야하여 오버헤드가 크다. 이는 DB대신 어떤 집합에 특정 원소가 검사할 수 있도록 하는 <strong>블룸 필터</strong>를 사용하면 성능을 높일 수 있다.</p>\n<h3 id=\"해시-함수-2---base-62-변환\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EC%8B%9C-%ED%95%A8%EC%88%98-2---base-62-%EB%B3%80%ED%99%98\" aria-label=\"해시 함수 2   base 62 변환 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해시 함수 2 - base-62 변환</h3>\n<p>진법 변환(base conversion)은 URL 단축기를 구현할 때 흔히 사용되는 접근법 중 하나이다. 해당 방법은 수의 표현 방식이 다른 두 시스템이 같은 수를 공유해야 하는 경우에 유용하다.</p>\n<blockquote>\n<p>62진법을 사용한 이유는 해시 값에 [A-Z, a-z, 0-9]의 문자들로 각각 62개의 값이 위치할 수 있기 때문이다.</p>\n<p>0-9는 숫자 0-9로, 10-35는 a-z로, 36-61은 A-Z로 대응시켜 표현하게 된다.</p>\n</blockquote>\n<h3 id=\"두-방법-비교\" style=\"position:relative;\"><a href=\"#%EB%91%90-%EB%B0%A9%EB%B2%95-%EB%B9%84%EA%B5%90\" aria-label=\"두 방법 비교 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>두 방법 비교</h3>\n<table>\n<thead>\n<tr>\n<th>해시 후 충돌 해소 전략</th>\n<th>base-62 변환</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>단축 URL의 길이가 고정됨</td>\n<td>단축 URL의 길이가 가변적이고 ID의 값이 커지면 같이 길어진다.</td>\n</tr>\n<tr>\n<td>유일성이 보장되는 ID 생성기가 필요치 않다</td>\n<td>유일성이 보장되는 ID 생성기가 필요하다.</td>\n</tr>\n<tr>\n<td>충돌이 가능해서 해소 전략이 필요하다.</td>\n<td>ID의 유일성이 보장된 후에야 적용 가능한 전략이라 충돌이 아예 불가능하다.</td>\n</tr>\n<tr>\n<td>ID로부터 단축 URL을 계산하는 방식이 아니라 다음에 쓸 URL을 알아내는 것이 불가능하다.</td>\n<td>ID가 1씩 증가하는 값이라 가정하면 다음에 쓸 수 있는 단축 URL이 무엇인지 쉽게 알아낼 수 있어 보안상 문제가 될 수 있다.</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"url-단축용-엔드포인트-상세-과정\" style=\"position:relative;\"><a href=\"#url-%EB%8B%A8%EC%B6%95%EC%9A%A9-%EC%97%94%EB%93%9C%ED%8F%AC%EC%9D%B8%ED%8A%B8-%EC%83%81%EC%84%B8-%EA%B3%BC%EC%A0%95\" aria-label=\"url 단축용 엔드포인트 상세 과정 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>URL 단축용 엔드포인트 상세 과정</h1>\n<blockquote>\n<p>Base-62를 통해 동작하는 과정입니다.</p>\n</blockquote>\n<ol>\n<li>입력으로 긴 URL을 받는다.</li>\n<li>데이터베이스에 해당 URL이 있는지 검사한다.</li>\n<li>데이터베이스에 있다면 해당 URL에 대한 단축 URL을 만든 적이 있는거라 데이터를 가져와서 Location헤더 필드에 값을 담아서 반환한다.</li>\n<li>데이터베이스에 없는 경우, ID 생성기를 통해 데이터베이스의 기본 키로 사용할 새로운 ID를 생성한다. (ID는 Global Unique가 보장되어야 한다.)</li>\n<li>62진법 변환을 적용해 ID를 단축 URL로 만든다.</li>\n<li>{ID, 단축 URL, 원래 URL}의 데이터를 데이터베이스에 저장한다.</li>\n<li>단축 URL을 Location 헤더 필드에 담아서 반환한다.</li>\n</ol>\n<h1 id=\"url-redirection용-엔드포인트-상세-과정\" style=\"position:relative;\"><a href=\"#url-redirection%EC%9A%A9-%EC%97%94%EB%93%9C%ED%8F%AC%EC%9D%B8%ED%8A%B8-%EC%83%81%EC%84%B8-%EA%B3%BC%EC%A0%95\" aria-label=\"url redirection용 엔드포인트 상세 과정 permalink\" class=\"toc-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>URL Redirection용 엔드포인트 상세 과정</h1>\n<ol>\n<li>사용자가 단축 URL을 클릭한다.</li>\n<li>로드밸런서가 해당 클릭으로 발생한 요청을 웹서버에 전달한다.</li>\n<li>단축 URL에 대한 정보가 캐시에 있을 경우 바로 URL을 반환한다.</li>\n<li>캐시에 단축 URL이 없는 경우 데이터베이스에서 조회한다. (데이터베이스에 값이 없다면 단축 URL이 잘못된 것이다.)</li>\n<li>데이터베이스에서 조회한 URL을 캐시에 넣은 후 사용자에게 반환한다.</li>\n</ol>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .one-dark-pro {\n    background-color: #282c34;\n    color: #abb2bf;\n  }\n  .one-dark-pro .mtk1 { color: #ABB2BF; }\n  .one-dark-pro .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","tableOfContents":"<ul>\n<li><a href=\"/Book/20230403-%EA%B0%80%EC%83%81%EB%A9%B4%EC%A0%91_Chapter8/#%EB%AC%B8%EC%A0%9C-%EC%9D%B4%ED%95%B4-%EB%B0%8F-%EC%84%A4%EA%B3%84-%EB%B2%94%EC%9C%84-%ED%99%95%EC%A0%95\">문제 이해 및 설계 범위 확정</a></li>\n<li><a href=\"/Book/20230403-%EA%B0%80%EC%83%81%EB%A9%B4%EC%A0%91_Chapter8/#api-%EC%97%94%EB%93%9C-%ED%8F%AC%EC%9D%B8%ED%8A%B8\">API 엔드 포인트</a></li>\n<li>\n<p><a href=\"/Book/20230403-%EA%B0%80%EC%83%81%EB%A9%B4%EC%A0%91_Chapter8/#url-%EB%8B%A8%EC%B6%95\">URL 단축</a></p>\n<ul>\n<li><a href=\"/Book/20230403-%EA%B0%80%EC%83%81%EB%A9%B4%EC%A0%91_Chapter8/#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%AA%A8%EB%8D%B8\">데이터 모델</a></li>\n<li>\n<p><a href=\"/Book/20230403-%EA%B0%80%EC%83%81%EB%A9%B4%EC%A0%91_Chapter8/#%ED%95%B4%EC%8B%9C-%ED%95%A8%EC%88%98\">해시 함수</a></p>\n<ul>\n<li><a href=\"/Book/20230403-%EA%B0%80%EC%83%81%EB%A9%B4%EC%A0%91_Chapter8/#%ED%95%B4%EC%8B%9C-%ED%95%A8%EC%88%98-1---%ED%95%B4%EC%8B%9C-%EC%B6%A9%EB%8F%8C-%ED%95%B4%EC%86%8C-%EB%B0%A9%EB%B2%95\">해시 함수 1 - 해시 충돌 해소 방법</a></li>\n<li><a href=\"/Book/20230403-%EA%B0%80%EC%83%81%EB%A9%B4%EC%A0%91_Chapter8/#%ED%95%B4%EC%8B%9C-%ED%95%A8%EC%88%98-2---base-62-%EB%B3%80%ED%99%98\">해시 함수 2 - base-62 변환</a></li>\n<li><a href=\"/Book/20230403-%EA%B0%80%EC%83%81%EB%A9%B4%EC%A0%91_Chapter8/#%EB%91%90-%EB%B0%A9%EB%B2%95-%EB%B9%84%EA%B5%90\">두 방법 비교</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/Book/20230403-%EA%B0%80%EC%83%81%EB%A9%B4%EC%A0%91_Chapter8/#url-%EB%8B%A8%EC%B6%95%EC%9A%A9-%EC%97%94%EB%93%9C%ED%8F%AC%EC%9D%B8%ED%8A%B8-%EC%83%81%EC%84%B8-%EA%B3%BC%EC%A0%95\">URL 단축용 엔드포인트 상세 과정</a></li>\n<li><a href=\"/Book/20230403-%EA%B0%80%EC%83%81%EB%A9%B4%EC%A0%91_Chapter8/#url-redirection%EC%9A%A9-%EC%97%94%EB%93%9C%ED%8F%AC%EC%9D%B8%ED%8A%B8-%EC%83%81%EC%84%B8-%EA%B3%BC%EC%A0%95\">URL Redirection용 엔드포인트 상세 과정</a></li>\n</ul>","frontmatter":{"date":"2023년 04월 03일","title":"[가상 면접 사례로 배우는 대규모 시스템 설계 기초] 8장. URL 단축기 설계","tags":["가상 면접 사례로 배우는 대규모 시스템 설계 기초"]}}},"pageContext":{"slug":"/Book/20230403-가상면접_Chapter8/","previous":{"fields":{"slug":"/Book/20230401-가상면접_Chapter7/"},"frontmatter":{"title":"[가상 면접 사례로 배우는 대규모 시스템 설계 기초] 7장. 분산 시스템을 위한 유일 ID 생성기 설계"}},"next":{"fields":{"slug":"/Book/20230404-가상면접_Chapter9/"},"frontmatter":{"title":"[가상 면접 사례로 배우는 대규모 시스템 설계 기초] 9장. 웹 크롤러 설계"}}}},"staticQueryHashes":["3911196313","4111100897"]}